---
title: "Simulate Diagnostic Histories"
author: "Phillip Labuschagne"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Simulate Diagnostic Histories}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r}
library(tsic)
```


IN PROGRESS

This is a guide for simulating diagnostic test histories. It uses the window period distributions built into `tsic` to simulate histories that have the exact assumptions that `tsic` uses.

* Simulating diagnostic test results if you know the time since infection.
* Simulating the time until first positive

## Getting diagnostic test results if you know the time since infection.

The `sim_dx_function` will produce a set of diagnostic test results given a time since infection. Note:

* The function must be provided with a character vector specifying the assays to consider and that this vector must be ordered from the fastest assay to the slowest assay.

```{r}
list_of_assays <- c("taqman_weib3_delaney_and_manufacturer", "architect_weib3_delaney", 
                    "geenius_indet_weib3_delaney", "geenius_fr_weib3_delaney")
tsi <- 25 # time since infection

print(sim_dx_results(tsi, list_of_assays))
```

Note that for this function, successive calls are independent of each other. So it is a poor tool if you want to simulate a diagnostic test trajectory for any single participant. For example the RNA assay can be positive 4 days after infection on the first run of the function and then be negative 5 days after infection on the second run of the function. If the visits are spaced far enough apart, then such concerns are much lower, but if you want to build up a consistent history for a participant, then this is not the right tool for the job.

```{r}
for (i in 1:40){
  # twiddle thumbs
}
```


